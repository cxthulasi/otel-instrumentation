<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coralogix RUM and OpenTelemetry Documentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 20px 0;
            overflow-x: hidden;
            overflow-y: auto;
            background-color: #f8f9fa;
            border-right: 1px solid #dee2e6;
        }
        .sidebar-sticky {
            position: sticky;
            top: 0;
            height: calc(100vh - 48px);
            padding-top: 0.5rem;
            overflow-x: hidden;
            overflow-y: auto;
        }
        .nav-link {
            font-weight: 500;
            color: #333;
        }
        .nav-link.active {
            color: #007bff;
        }
        .main-content {
            margin-left: 240px;
            padding: 20px;
        }
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 10px;
            overflow-x: auto;
        }
        code {
            font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 0.9em;
            color: #e83e8c;
        }
        h1, h2, h3, h4, h5, h6 {
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        .mermaid {
            margin: 20px 0;
        }
        @media (max-width: 768px) {
            .sidebar {
                position: static;
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #dee2e6;
            }
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-3 col-lg-2 d-md-block sidebar">
                <div class="sidebar-sticky">
                    <h5 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>Documentation</span>
                    </h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-file="index.md">
                                Home
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="architecture.md">
                                Architecture Overview
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="frontend.md">
                                Frontend Documentation
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="backend.md">
                                Backend Documentation
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="trace-correlation.md">
                                Trace Correlation
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="deployment.md">
                                Deployment Guide
                            </a>
                        </li>
                    </ul>
                    <h5 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>Diagrams</span>
                    </h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="images/architecture-diagram.md">
                                Architecture Diagram
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="images/trace-correlation-diagram.md">
                                Trace Correlation Flow
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-file="images/coralogix-rum-methods.md">
                                Coralogix RUM Methods
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4 main-content">
                <div id="content"></div>
            </main>
        </div>
    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: { useMaxWidth: true }
        });

        // Load markdown file and render it
        async function loadMarkdown(file) {
            try {
                const response = await fetch(file);
                if (!response.ok) {
                    throw new Error(`Failed to load ${file}: ${response.status} ${response.statusText}`);
                }
                const text = await response.text();
                document.getElementById('content').innerHTML = marked.parse(text);
                
                // Update active link
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('data-file') === file) {
                        link.classList.add('active');
                    }
                });

                // Render Mermaid diagrams
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            } catch (error) {
                console.error('Error loading markdown:', error);
                document.getElementById('content').innerHTML = `<div class="alert alert-danger">Error loading document: ${error.message}</div>`;
            }
        }

        // Add click event listeners to navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const file = link.getAttribute('data-file');
                loadMarkdown(file);
            });
        });

        // Load the initial markdown file
        loadMarkdown('index.md');
    </script>
</body>
</html>
